# 【R05-018】历史记录
<a id="R05-018"></a>

- **Requirement ID**：【R05-018】
- **Feature name**：历史记录
- **Source**：模块05：人员相关 15% > 教职工管理 > 考勤 > 请假 > 历史记录
- **Applicable Platform/Entry**：小程序（教职工/教师端） / 模块05 / 历史记录
- **User Roles & Permission Requirements**：
  - 可执行角色：教职工（教师/班主任/行政等）
  - 权限点（最小粒度）：`req:R05-018`
  -（可选）通用权限点：`people:read`
  - 视角/范围：不涉及后台双视角切换；以绑定/所属学校 `school_id` 与身份关系为边界。
- **User Stories**：
  - 场景 1：作为教职工（教师/班主任/行政等），我希望能够完成“历史记录”，以便在权限允许且 `school_id` 隔离范围内推进业务。
  - 场景 2：作为教职工（教师/班主任/行政等），我希望能分页查看数据并按关键字/状态筛选，以便快速定位目标记录。
  - 场景 3：作为移动端用户，我希望在弱网/重复点击时系统能避免重复提交并给出明确提示。
- **Business Rules & Boundaries**：
  - 输入校验：所有 UUID 入参必须校验格式；非法输入应返回可定位的错误。
  - 列表必须分页；`limit<=100`；支持必要筛选（如关键字/状态）与稳定排序（如按创建时间）。
- **Data Scope（school_id）**：
  - 仅允许访问与当前用户身份绑定的 `school_id` 数据（不可跨校）。
  - 仅允许访问与本人/授权关系相关的数据（学生本人、监护关系、任教/岗位范围等）。
- **Audit Log Requirements**：
  - Recommended：登录/绑定/信息修改/提交等关键行为建议记录操作日志（至少包含 operator_id、school_id、action、resource_type/id、timestamp）。
- **Acceptance Criteria（verifiable）**：
  - 验收模板：`T-LIST`
  - 验收用例：
    1. 权限校验：具备 `req:R05-018`（及必要通用权限点）才允许执行；无权限必须拒绝。
    2. 租户隔离：尝试跨 school_id（或未授权 X-View-Scope）访问/操作必须失败；不得出现跨校可查/可改。
    3. 输入校验：UUID/必填字段/格式校验失败时应返回明确错误。
    4. 列表分页：支持 page/limit（或 offset/limit）；强制 `limit<=100`；返回总数/分页信息一致。
    5. 列表过滤：至少支持按关键字/状态等基础条件筛选（若无则可为空，但需不影响隔离与分页）。

## 相关需求（See also）
- [【R05-016】审批/驳回](./req-R05-016.md)
- [【R05-015】请假申请](./req-R05-015.md)
- [【R05-017】销假](./req-R05-017.md)

## 导航
- 返回模块 README：[./README.md](./README.md)
- 返回平台 README：[../README.md](../README.md)
- PRD 总入口：[../../README.md](../../README.md)
- 追溯矩阵：[../../traceability-matrix.md](../../traceability-matrix.md)
