# 【R07-009】章节填充
<a id="R07-009"></a>

- **Requirement ID**：【R07-009】
- **Feature name**：章节填充
- **Source**：模块07：在线学习 15% > 课程管理 > 增加/修改课程 > 课程结构 > 课程列表 > 章节填充
- **Applicable Platform/Entry**：Web 管理端（集团/学校双视角） / 模块07 / 章节填充
- **User Roles & Permission Requirements**：
  - 可执行角色：教务管理员、任课教师（管理课程资源）、学校管理员（School）、集团管理员（Group，进入学校视角）
  - 权限点（最小粒度）：`req:R07-009`
  - 视角/范围：学校视角仅本校；集团视角可 `X-View-Scope` 切换（进入学校视角必须审计）。
- **User Stories**：
  - 场景 1：作为教务管理员，我希望能够完成“章节填充”，以便在权限允许且 `school_id` 隔离范围内推进业务。
  - 场景 2：作为教务管理员，我希望能分页查看数据并按关键字/状态筛选，以便快速定位目标记录。
  - 场景 3：作为集团管理员（Group），我希望能在授权后进入指定学校视角代办该操作，并留下可追溯的审计记录。
- **Business Rules & Boundaries**：
  - 输入校验：所有 UUID 入参必须校验格式；非法输入应返回可定位的错误。
  - 列表必须分页；`limit<=100`；支持必要筛选（如关键字/状态）与稳定排序（如按创建时间）。
  - 写入/更新必须绑定正确的 `school_id`；`school_id` 写入后不可修改；禁止跨校写入。
  - 防重复提交：对“新增/申请/发送/导入”等写操作，需具备最小幂等策略（例如请求去重/重复提交提示）。
  - 越权禁止：学校视角不得跨校查询/修改；集团视角进入指定学校视角也必须在授权范围内。
- **Data Scope（school_id）**：
  - 学校视角：仅允许访问当前请求上下文的 `school_id` 数据。
  - 集团视角：可 `X-View-Scope: all` 查看集团汇总；如需对单校进行查看/操作，必须切换 `X-View-Scope: {school_uuid}`。
  - 禁止：未授权学校的任何明细查询/写入/修改。
- **Audit Log Requirements**：
  - Required：集团人员进入学校视角（`X-View-Scope: {school_uuid}`）执行 VIEW/CREATE/UPDATE/DELETE 必须审计。
  - 字段：operator_id/operator_name/target_school_id/action/resource_type/resource_id/trace_id/timestamp。
- **Acceptance Criteria（verifiable）**：
  - 验收模板：`T-GENERAL`
  - 验收用例：
    1. 权限校验：具备 `req:R07-009`（及必要通用权限点）才允许执行；无权限必须拒绝。
    2. 租户隔离：尝试跨 school_id（或未授权 X-View-Scope）访问/操作必须失败；不得出现跨校可查/可改。
    3. 输入校验：UUID/必填字段/格式校验失败时应返回明确错误。
    4. 审计：集团人员在学校视角执行本需求对应动作时，必须写入审计日志且字段齐全。
    5. 列表分页：支持 page/limit（或 offset/limit）；强制 `limit<=100`；返回总数/分页信息一致。
    6. 列表过滤：至少支持按关键字/状态等基础条件筛选（若无则可为空，但需不影响隔离与分页）。
    7. 新增成功：返回资源唯一标识（UUID）；写入 `school_id` 正确且不可变。
    8. 重复提交：同一业务关键字段或幂等键重复提交时，系统应避免产生重复数据并给出可解释结果。
    9. 更新边界：仅允许修改允许字段；`school_id` 不可修改；并发更新需有冲突处理（如更新时间校验）。
    10. 功能可用性：按需求描述完成对应能力，且不违反权限/隔离/审计门禁。

## 相关需求（See also）
- [【R07-008】单元填充](./req-R07-008.md)
- [【R07-010】版本管理](./req-R07-010.md)
- [【R07-007】对应教师讲解结构](./req-R07-007.md)

## 导航
- 返回模块 README：[./README.md](./README.md)
- 返回平台 README：[../README.md](../README.md)
- PRD 总入口：[../../README.md](../../README.md)
- 追溯矩阵：[../../traceability-matrix.md](../../traceability-matrix.md)
