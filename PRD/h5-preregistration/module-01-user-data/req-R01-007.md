# 【R01-007】自行小程序匹配
<a id="R01-007"></a>

- **Requirement ID**：【R01-007】
- **Feature name**：自行小程序匹配
- **Source**：模块01：用户数据 > 用户注册 > 外部用户 > 基础预注册H5 > 关键信息录入 > 自行小程序匹配
- **Applicable Platform/Entry**：基础预注册 H5 / 模块01 / 自行小程序匹配
- **User Roles & Permission Requirements**：
  - 可执行角色：外部用户（预注册填写人）、审核人（学校管理员/招生相关岗位）
  - 权限点（最小粒度）：`req:R01-007`
  - 视角/范围：不涉及后台双视角切换；以预注册选择/归属的目标学校 `school_id` 为边界。
- **User Stories**：
  - 场景 1：作为外部用户（预注册填写人），我希望能够完成“自行小程序匹配”，以便在权限允许且 `school_id` 隔离范围内推进业务。
  - 场景 2：作为外部用户（预注册填写人），我希望完成登录/绑定/验证流程，并在失败时得到明确原因（不泄露敏感信息）。
- **Business Rules & Boundaries**：
  - 输入校验：所有 UUID 入参必须校验格式；非法输入应返回可定位的错误。
- **Data Scope（school_id）**：
  - 预注册提交必须明确归属目标学校 `school_id`（禁止写入到其它学校）。
  - 审核/管理侧查看与操作仅限其授权学校范围。
- **Audit Log Requirements**：
  - Required：管理端审核/退回/删除等操作必须审计。
  - Recommended：H5 提交记录建议留痕（便于追溯与风控）。
- **Acceptance Criteria（verifiable）**：
  - 验收模板：`T-GENERAL`
  - 验收用例：
    1. 权限校验：具备 `req:R01-007`（及必要通用权限点）才允许执行；无权限必须拒绝。
    2. 租户隔离：尝试跨 school_id（或未授权 X-View-Scope）访问/操作必须失败；不得出现跨校可查/可改。
    3. 输入校验：UUID/必填字段/格式校验失败时应返回明确错误。
    4. 新增成功：返回资源唯一标识（UUID）；写入 `school_id` 正确且不可变。
    5. 重复提交：同一业务关键字段或幂等键重复提交时，系统应避免产生重复数据并给出可解释结果。
    6. 功能可用性：按需求描述完成对应能力，且不违反权限/隔离/审计门禁。

## 相关需求（See also）
- [【R01-006】退回、删除](../../web-admin/module-01-user-data/req-R01-006.md)
- [【R01-005】可编辑用户](../../web-admin/module-01-user-data/req-R01-005.md)
- [【R01-008】关联教师信息系统](../../web-admin/module-01-user-data/req-R01-008.md)

## 导航
- 返回模块 README：[./README.md](./README.md)
- 返回平台 README：[../README.md](../README.md)
- PRD 总入口：[../../README.md](../../README.md)
- 追溯矩阵：[../../traceability-matrix.md](../../traceability-matrix.md)
