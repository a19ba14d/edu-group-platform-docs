# 【R01-015】手机号
<a id="R01-015"></a>

- **Requirement ID**：【R01-015】
- **Feature name**：手机号
- **Source**：模块01：用户数据 > 用户注册 > 补充功能 > 小程序相关 （教师学生信息功能完成后） > 关联个人信息 > 修改信息 > 手机号
- **Applicable Platform/Entry**：小程序（家长端） / 模块01 / 手机号
- **User Roles & Permission Requirements**：
  - 可执行角色：家长/监护人
  - 权限点（最小粒度）：`req:R01-015`
  - 视角/范围：不涉及后台双视角切换；以绑定/所属学校 `school_id` 与身份关系为边界。
- **User Stories**：
  - 场景 1：作为家长/监护人，我希望能够完成“手机号”，以便在权限允许且 `school_id` 隔离范围内推进业务。
  - 场景 2：作为家长/监护人，我希望完成登录/绑定/验证流程，并在失败时得到明确原因（不泄露敏感信息）。
  - 场景 3：作为移动端用户，我希望在弱网/重复点击时系统能避免重复提交并给出明确提示。
- **Business Rules & Boundaries**：
  - 输入校验：所有 UUID 入参必须校验格式；非法输入应返回可定位的错误。
  - 写入/更新必须绑定正确的 `school_id`；`school_id` 写入后不可修改；禁止跨校写入。
  - 防重复提交：对“新增/申请/发送/导入”等写操作，需具备最小幂等策略（例如请求去重/重复提交提示）。
  - 鉴权/绑定类操作必须有清晰的成功/失败分支；失败原因可解释（如验证码错误/过期、未绑定等）。
  - 安全边界：不得明文存储密码/敏感凭证；会话/令牌应可被失效/撤销（最小可验收）。
- **Data Scope（school_id）**：
  - 仅允许访问与当前用户身份绑定的 `school_id` 数据（不可跨校）。
  - 仅允许访问与本人/授权关系相关的数据（学生本人、监护关系、任教/岗位范围等）。
- **Audit Log Requirements**：
  - Recommended：登录/绑定/信息修改/提交等关键行为建议记录操作日志（至少包含 operator_id、school_id、action、resource_type/id、timestamp）。
- **Acceptance Criteria（verifiable）**：
  - 验收模板：`T-GENERAL`
  - 验收用例：
    1. 权限校验：具备 `req:R01-015`（及必要通用权限点）才允许执行；无权限必须拒绝。
    2. 租户隔离：尝试跨 school_id（或未授权 X-View-Scope）访问/操作必须失败；不得出现跨校可查/可改。
    3. 输入校验：UUID/必填字段/格式校验失败时应返回明确错误。
    4. 更新边界：仅允许修改允许字段；`school_id` 不可修改；并发更新需有冲突处理（如更新时间校验）。
    5. 鉴权成功：返回可解析的登录态（例如 JWT），包含 org_type/org_id/role/school_id（或等价租户信息）。
    6. 鉴权失败：可复现并可定位（如账号/验证码错误、过期、第三方未绑定等），不泄露敏感信息。
    7. 功能可用性：按需求描述完成对应能力，且不违反权限/隔离/审计门禁。
- **备注**：家长端与教职工端均可能涉及手机号修改；主归属家长端，教职工端如需复用按差异说明。

## 相关需求（See also）
- [【R01-016】地址等](./req-R01-016.md)
- [【R01-013】学生家长关联](./req-R01-013.md)
- [【R01-024】手机验证码登录](./req-R01-024.md)

## 导航
- 返回模块 README：[./README.md](./README.md)
- 返回平台 README：[../README.md](../README.md)
- PRD 总入口：[../../README.md](../../README.md)
- 追溯矩阵：[../../traceability-matrix.md](../../traceability-matrix.md)
